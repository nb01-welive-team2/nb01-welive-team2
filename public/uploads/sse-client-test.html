<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>SSE client test</h1>
    <form id="form">
      <input type="text" id="token" placeholder="JWT Access Token" />
      <button id="connect">Connect</button>
    </form>
    <p>swagger에서 로그인해서 accessToken을 얻어 사용<br>
  본 페이지의 개발자 도구로 네트워크 혹은 콘솔 탭에서 알림 확인</p>

    <script>
      const form = document.getElementById('form');
      const tokenInput = document.getElementById('token');

      form.addEventListener('submit', (e) => {
      e.preventDefault();
      const accessToken = tokenInput.value;

      // SSE 연결
      const eventSource = new EventSource(`/api/notifications/sse?token=${accessToken}`);

      eventSource.onopen = () => {
        console.log("SSE 연결 성공");
      };

      eventSource.onmessage = (event) => {
        const data = JSON.parse(event.data);
        console.log("알림 데이터:", data);
      };

      eventSource.onerror = () => {
        console.log("SSE 연결 오류");
      };
    });
    </script>
  </body>
</html>
